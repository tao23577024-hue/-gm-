<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的基金实盘 - 鸡煲</title>
    
    <script src="https://cdn.staticfile.net/vue/3.3.4/vue.global.prod.min.js"></script>
    <script src="https://cdn.staticfile.net/echarts/5.4.3/echarts.min.js"></script>
    
    <style>
        :root {
            --bg-color: #050505;
            --panel-bg: #101014;
            --border-color: #2a2a2a;
            --header-bg: #15151a;
            --text-main: #e0e0e0;
            --text-sub: #888;
            --accent: #2979ff;
            --up: #ff333a;       
            --down: #00e676;     
            --hover-bg: #1f1f25;
            --active-bg: #0d1b2e;
            --font-size-base: 12px;
        }

        html.light {
            --bg-color: #f0f2f5; --panel-bg: #ffffff; --border-color: #d9d9d9;
            --header-bg: #e6f7ff; --text-main: #333333; --text-sub: #666666;
            --up: #f5222d; --down: #52c41a; --hover-bg: #f5f5f5; --active-bg: #e6f7ff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            background-color: var(--bg-color); 
            color: var(--text-main); 
            font-family: "Consolas", "Microsoft YaHei", monospace; 
            height: 100vh; width: 100vw; overflow: hidden; 
            font-size: var(--font-size-base);
        }

        /* --- 核心布局：三栏 --- */
        .layout {
            display: grid;
            /* 左(列表) | 中(图表数据) | 右(紧凑操作) */
            grid-template-columns: 240px 1fr 200px; 
            grid-template-rows: 60px minmax(0, 1fr); 
            gap: 4px; padding: 4px;
            height: 100vh;
        }

        /* 通用面板 */
        .panel {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            display: flex; flex-direction: column;
            overflow: hidden; border-radius: 4px;
        }
        .panel-header {
            height: 28px; flex-shrink: 0;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 8px;
            background: var(--header-bg);
            border-bottom: 1px solid var(--border-color);
            font-weight: bold; color: var(--accent);
            font-size: var(--font-size-base);
        }

        /* --- 1. 顶部数据条 --- */
        .top-bar {
            grid-column: 1 / 4;
            display: flex; align-items: center; justify-content: space-around;
            background: var(--panel-bg); border: 1px solid var(--border-color);
            border-radius: 4px;
        }
        .stat-box { text-align: center; }
        .stat-label { color: var(--text-sub); font-size: 11px; margin-bottom: 2px;}
        .stat-val { font-size: 18px; font-weight: bold; font-family: sans-serif; }

        /* --- 2. 左侧：基金列表 --- */
        .col-left { grid-row: 2 / 3; grid-column: 1 / 2; }
        .fund-list { flex: 1; overflow-y: auto; }
        .fund-item { padding: 8px; border-bottom: 1px solid var(--border-color); cursor: pointer; }
        .fund-item:hover { background: var(--hover-bg); }
        .fund-item.active { background: var(--active-bg); border-left: 2px solid var(--accent); }
        .fi-row { display: flex; justify-content: space-between; align-items: baseline; }
        .fi-name { font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 140px; }

        /* --- 3. 中间：图表 + 数据 --- */
        .col-center { 
            grid-row: 2 / 3; grid-column: 2 / 3; 
            display: grid; grid-template-rows: 2fr 1fr; gap: 4px; 
            min-height: 0; 
        }
        .chart-area { width: 100%; height: 100%; position: relative; }
        .data-area { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; overflow: hidden; min-height: 0; }
        
        /* 表格样式 */
        .data-table { width: 100%; border-collapse: collapse; font-size: 11px; }
        .data-table th, .data-table td { text-align: right; padding: 4px 6px; border-bottom: 1px solid var(--border-color); white-space: nowrap; }
        .data-table th { position: sticky; top: 0; background: var(--panel-bg); color: var(--text-sub); z-index: 1; }
        .data-table td.name-col { text-align: left; max-width: 100px; overflow: hidden; text-overflow: ellipsis; }

        /* --- 4. 右侧：紧凑操作栏 --- */
        .col-right { grid-row: 2 / 3; grid-column: 3 / 4; padding: 0; gap: 4px; border:none; background: transparent; box-shadow: none; display: flex; flex-direction: column; overflow: hidden;}
        
        .control-panel {
            background: var(--panel-bg); border: 1px solid var(--border-color); border-radius: 4px;
            padding: 8px; display: flex; flex-direction: column; gap: 8px;
        }
        
        .compact-row { display: flex; flex-direction: column; gap: 2px; }
        .compact-label { font-size: 10px; color: var(--text-sub); }
        
        .input-group { display: flex; gap: 4px; align-items: center;}
        .input-mini { 
            flex: 1; background: var(--bg-color); border: 1px solid var(--border-color); 
            color: var(--text-main); padding: 4px; border-radius: 2px; font-size: 12px; outline: none; width: 0; 
        }
        .input-mini:focus { border-color: var(--accent); }
        
        .btn-mini {
            padding: 0 8px; height: 24px; font-size: 11px; border: none; border-radius: 2px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; white-space: nowrap;
        }
        .btn-blue { background: var(--accent); color: white; }
        .btn-red { background: #d32f2f; color: white; opacity: 0.8; }
        .btn-red:hover { opacity: 1; }

        .search-res { flex:1; overflow-y: auto; border: 1px solid var(--border-color); background: var(--bg-color); font-size: 11px; margin-top:2px; min-height: 0; }
        .search-row { padding: 6px; border-bottom: 1px solid var(--border-color); cursor: pointer; }
        .search-row:hover { background: var(--hover-bg); }

        .tools-row { display: flex; justify-content: space-between; margin-top: auto; padding-top: 5px; border-top: 1px dashed var(--border-color); }
        .tool-icon { cursor: pointer; opacity: 0.6; font-size: 14px; }
        .tool-icon:hover { opacity: 1; color: var(--accent); }

        .t-up { color: var(--up) !important; } .t-down { color: var(--down) !important; }
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        ::-webkit-scrollbar-track { background: transparent; }
    </style>
</head>
<body>

<div id="app" style="display:none;" class="layout">
    
    <header class="top-bar">
        <div class="stat-box">
            <div class="stat-label">今日收益</div>
            <div class="stat-val" :class="totalDailyProfit >= 0 ? 't-up' : 't-down'">{{ totalDailyProfit }}</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">总资产</div>
            <div class="stat-val" style="color:var(--text-main)">{{ settings.privacyMode ? '****' : totalAssetValue }}</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">日涨幅</div>
            <div class="stat-val" :class="dailyTotalRate >= 0 ? 't-up' : 't-down'">{{ dailyTotalRate }}%</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">刷新</div>
            <div class="stat-val" style="font-size:14px; color:var(--text-sub)">{{ refreshCountdown }}s</div>
        </div>
    </header>

    <aside class="panel col-left">
        <div class="panel-header">
            <span>基金池 ({{ funds.length }})</span>
            <span style="cursor:pointer" @click="manualRefresh">↻</span>
        </div>
        <div class="fund-list">
            <div v-for="fund in funds" :key="fund.code" @click="selectFund(fund)" class="fund-item" :class="{ 'active': selectedFundCode === fund.code }">
                <div class="fi-row">
                    <span class="fi
